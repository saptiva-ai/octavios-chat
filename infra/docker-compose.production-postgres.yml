# ========================================
# PRODUCTION POSTGRES OVERRIDE
# ========================================
# Use this to connect bank-advisor to production PostgreSQL on GCP
# instead of the local postgres container.
#
# Usage:
#   docker compose -f docker-compose.yml -f docker-compose.production-postgres.yml up bank-advisor
#
# This file:
# - Overrides POSTGRES_HOST to point to GCP production instance
# - Uses production credentials from .env
# - Skips dependency on local postgres container
# - Keeps Qdrant and other services from main docker-compose.yml

services:
  bank-advisor:
    environment:
      # Override PostgreSQL to use GCP production instance
      # Set these values in envs/.env.prod or environment variables
      - POSTGRES_HOST=${POSTGRES_HOST}
      - POSTGRES_PORT=${POSTGRES_PORT:-5432}
      - POSTGRES_USER=${POSTGRES_USER}
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
      - POSTGRES_DB=${POSTGRES_DB:-bankadvisor}
      - DATABASE_URL=postgresql+asyncpg://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT:-5432}/${POSTGRES_DB:-bankadvisor}

    # Remove dependency on local postgres container
    # Qdrant dependency removed - will gracefully fallback if not available
    depends_on: []
