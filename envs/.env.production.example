# ============================================================================
# PRODUCTION ENVIRONMENT CONFIGURATION TEMPLATE
# ============================================================================
# Copy this file to .env and replace placeholder values
# DO NOT commit actual credentials to git

# ============================================================================
# BASIC CONFIGURATION
# ============================================================================
COMPOSE_PROJECT_NAME=octavios
DOMAIN=your-server-ip-or-domain
APP_VERSION=latest

# ============================================================================
# FRONTEND CONFIGURATION
# ============================================================================
NEXT_PUBLIC_API_URL=http://your-server-ip:8001
NODE_ENV=production
NEXT_TELEMETRY_DISABLED=1

# File upload limits (must match backend and nginx)
NEXT_PUBLIC_MAX_FILE_SIZE_MB=50

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
MONGODB_USER=octavios_prod_user
MONGODB_PASSWORD=CHANGE_ME_STRONG_PASSWORD_32_CHARS_MIN
MONGODB_DATABASE=octavios
MONGODB_PORT=27017

# MongoDB URL (auto-constructed)
# MONGODB_URL=mongodb://${MONGODB_USER}:${MONGODB_PASSWORD}@mongodb:27017/${MONGODB_DATABASE}?authSource=admin

REDIS_PASSWORD=CHANGE_ME_STRONG_PASSWORD_32_CHARS_MIN
REDIS_PORT=6379
REDIS_MAX_MEMORY=512mb

# Redis URL (auto-constructed)
# REDIS_URL=redis://:${REDIS_PASSWORD}@redis:6379/0

# ============================================================================
# POSTGRESQL CONFIGURATION (GCP)
# ============================================================================
# External PostgreSQL for bank-advisor plugin (INVEX banking data)
# Production uses GCP Cloud SQL - local postgres container is disabled
POSTGRES_HOST=your-gcp-sql-ip-address
POSTGRES_PORT=5432
POSTGRES_USER=octavios_prod_user
POSTGRES_PASSWORD=CHANGE_ME_STRONG_PASSWORD_32_CHARS_MIN
POSTGRES_DB=bankadvisor

# PostgreSQL URL (auto-constructed for bank-advisor)
# DATABASE_URL=postgresql+asyncpg://${POSTGRES_USER}:${POSTGRES_PASSWORD}@${POSTGRES_HOST}:${POSTGRES_PORT}/${POSTGRES_DB}

# ============================================================================
# AUTHENTICATION / SECURITY
# ============================================================================
# Generate with: openssl rand -hex 32
JWT_SECRET_KEY=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_HEX_32
SECRET_KEY=CHANGE_ME_GENERATE_WITH_OPENSSL_RAND_HEX_32
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7
JWT_ALGORITHM=HS256

# ============================================================================
# EXTERNAL APIS
# ============================================================================
# SAPTIVA API (REQUIRED)
SAPTIVA_API_KEY=your-saptiva-api-key-here
SAPTIVA_BASE_URL=https://api.saptiva.com
SAPTIVA_TIMEOUT=120
SAPTIVA_MAX_RETRIES=3
SAPTIVA_CONNECT_TIMEOUT=30
SAPTIVA_READ_TIMEOUT=60

# Chat model configuration
CHAT_DEFAULT_MODEL=Saptiva Turbo
CHAT_ALLOWED_MODELS=Saptiva Turbo,Saptiva Cortex,Saptiva Ops

# Aletheia (optional - for deep research)
ALETHEIA_BASE_URL=https://aletheia.saptiva.ai
ALETHEIA_API_KEY=optional-aletheia-key
ALETHEIA_TIMEOUT=120
ALETHEIA_MAX_RETRIES=3

# ============================================================================
# PRODUCTION SETTINGS
# ============================================================================
DEBUG=false
LOG_LEVEL=info
RATE_LIMIT_REQUESTS_PER_MINUTE=100
MAX_PROMPT_LENGTH=50000

# File upload limit for backend (in bytes, must match frontend and nginx)
# 50MB = 52428800 bytes (matches nginx client_max_body_size 50M)
MAX_FILE_SIZE=52428800

# ============================================================================
# CORS & HOSTS
# ============================================================================
CORS_ORIGINS=["http://your-server-ip:3000","http://your-server-ip"]
ALLOWED_HOSTS=["your-server-ip","localhost","127.0.0.1"]

# ============================================================================
# OBSERVABILITY (OPTIONAL)
# ============================================================================
OTEL_SERVICE_NAME=octavios-bridge-prod
OTEL_ENABLED=false
JAEGER_ENDPOINT=http://localhost:14268/api/traces

# Sentry (optional)
# SENTRY_DSN=your-sentry-dsn-here
# SENTRY_ENVIRONMENT=production
# SENTRY_TRACES_SAMPLE_RATE=0.01

# ============================================================================
# PERFORMANCE
# ============================================================================
WORKERS=4
MAX_CONNECTIONS=100
POOL_SIZE=20

# Streaming
STREAM_BACKPRESSURE_MAX=2000
STREAM_HEARTBEAT_INTERVAL_MS=3000
SSE_KEEP_ALIVE_TIMEOUT_MS=45000

# ============================================================================
# DEPLOYMENT CONFIGURATION
# ============================================================================
# Required for automated deployment with make deploy, make deploy-registry, etc.
# Used by scripts/deploy.sh and scripts/rollback.sh

# Production server SSH access
PROD_SERVER_IP=your-server-ip-address
PROD_SERVER_USER=your-ssh-username
PROD_SERVER_HOST=${PROD_SERVER_USER}@${PROD_SERVER_IP}

# Deployment path on production server
PROD_DEPLOY_PATH=/opt/octavios-bridge

# Production domain (used for health checks and verification)
PROD_DOMAIN=your-production-domain.com

# Docker registry configuration (for registry-based deployments)
# Format: ghcr.io/username/repository
REGISTRY_URL=ghcr.io/your-github-username/octavios-bridge
REGISTRY_USER=your-github-username

# ============================================================================
# EMAIL / PASSWORD RESET CONFIGURATION
# ============================================================================
# SMTP Configuration for sending password reset emails via Gmail
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=support@saptiva.com
# IMPORTANT: Use Gmail App Password, not your regular password
# Generate at: https://myaccount.google.com/apppasswords
SMTP_PASSWORD=CHANGE_ME_GMAIL_APP_PASSWORD
SMTP_FROM_EMAIL=support@saptiva.com

# Base URL for password reset links (frontend URL)
# Production: Must be the actual domain where users access the frontend
PASSWORD_RESET_URL_BASE=https://414.saptiva.com

# ============================================================================
# NOTES
# ============================================================================
# 1. Replace all CHANGE_ME_* values with actual credentials
# 2. Generate strong secrets: openssl rand -hex 32
# 3. Use environment-specific values for DOMAIN and API URLs
# 4. Keep this file secure and never commit actual credentials
# 5. For production, consider using Docker secrets or vault solutions
# 6. DEPLOYMENT CONFIGURATION is required for make deploy / make deploy-registry
#    - Configure PROD_SERVER_* for SSH access
#    - Configure REGISTRY_* if using GHCR (GitHub Container Registry)
# 7. FILE UPLOAD LIMITS must be consistent across:
#    - MAX_FILE_SIZE (backend, in bytes)
#    - NEXT_PUBLIC_MAX_FILE_SIZE_MB (frontend, in MB)
#    - nginx client_max_body_size (infra/nginx/nginx.conf)
# 8. After updating this file, copy to production server at: $PROD_DEPLOY_PATH/envs/.env
#    Then restart services: cd $PROD_DEPLOY_PATH/infra && docker compose up -d --force-recreate
# 9. EMAIL CONFIGURATION:
#    - Generate Gmail App Password at: https://myaccount.google.com/apppasswords
#    - PASSWORD_RESET_URL_BASE must match your production domain (https://414.saptiva.com)
#    - Test email sending after deployment to verify SMTP configuration
# 10. POSTGRESQL CONFIGURATION:
#    - Production uses external GCP Cloud SQL PostgreSQL instance
#    - Local postgres container is disabled in production (profiles: ["local"])
#    - Configure POSTGRES_HOST with GCP Cloud SQL IP address
#    - Ensure GCP firewall allows connections from production server IP
#    - Test connection: psql -h $POSTGRES_HOST -U $POSTGRES_USER -d $POSTGRES_DB